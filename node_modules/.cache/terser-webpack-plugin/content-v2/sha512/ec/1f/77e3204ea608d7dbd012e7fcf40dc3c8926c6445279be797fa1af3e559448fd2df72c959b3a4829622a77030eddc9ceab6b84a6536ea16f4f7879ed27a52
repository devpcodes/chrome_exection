{"code":"!function(e){function t(t){for(var a,r,o=t[0],i=t[1],d=t[2],s=0,f=[];s<o.length;s++)r=o[s],l[r]&&f.push(l[r][0]),l[r]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);for(c&&c(t);f.length;)f.shift()();return u.push.apply(u,d||[]),n()}function n(){for(var e,t=0;t<u.length;t++){for(var n,r=u[t],o=!0,i=1;i<r.length;i++)n=r[i],0!==l[n]&&(o=!1);o&&(u.splice(t--,1),e=a(a.s=r[0]))}return e}function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}var r={},l={0:0},u=[];a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,\"a\",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p=\"\";var o=window.webpackJsonp=window.webpackJsonp||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=i;u.push([147,1]),n()}({141:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(115)).default.create({baseURL:\"http://localhost\",timeout:5e3});t.default=a},147:function(e,t,n){e.exports=n(148)},148:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}var r=a(n(1)),l=a(n(13)),u=a(n(153));l.default.render(r.default.createElement(u.default,null),document.getElementById(\"app\"))},153:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(11)),l=a(n(1)),u=a(n(154)),o=a(n(202)),i=a(n(341));n(399),t.default=function(){var e=(0,u.default)(),t=e.isLogin,n=e.loginHandler,a=(0,r.default)(e,[\"isLogin\",\"loginHandler\"]);return l.default.createElement(\"div\",null,t?l.default.createElement(i.default,a):l.default.createElement(o.default,{loginHandler:n}))}},154:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(63)),l=a(n(64)),u=a(n(177)),o=n(1),i=(a(o),a(n(115)));t.default=function(){var e=(0,o.useState)(!1),t=(0,u.default)(e,2),n=t[0],a=t[1],d=(0,o.useState)(\"\"),c=(0,u.default)(d,2),s=c[0],f=c[1],m=function(){var e=(0,l.default)(r.default.mark(function e(){var t;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(\"process env\",\"production\"),t=void 0,e.next=8;break;case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,i.default.get(\"http://localhost/api/current_user\");case 10:t=e.sent;case 11:t.data&&void 0!==t.data.name&&(a(!0),f(t.data.name));case 12:case\"end\":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)(function(){m()},[]),{isLogin:n,loginHandler:function(e){e&&(a(!0),f(e))},userName:s}}},202:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(79)),l=a(n(63)),u=a(n(64)),o=a(n(128)),i=a(n(138));n(93),n(139),n(140);var d=a(n(1)),c=a(n(141));n(339),t.default=o.default.create({})(function(e){var t=e.form,n=t.getFieldDecorator;return t.getFieldsError,t.getFieldError,t.isFieldTouched,d.default.createElement(\"div\",{className:\"login__box\"},d.default.createElement(o.default,null,d.default.createElement(o.default.Item,{label:\"輸入帳號\",hasFeedback:!0},n(\"account\",{initialValue:\"\",rules:[{required:!0,message:\"用戶名不能為空\"},{validator:function(e,t,n){\"\"===t&&n(),/^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/.test(t)?n():n(\"僅能輸入email格式\")}}]})(d.default.createElement(i.default,{placeholder:\"account\"}))),d.default.createElement(o.default.Item,{label:\"輸入密碼\",hasFeedback:!0},n(\"userPwd\",{initialValue:\"\",rules:[{required:!0,message:\"密碼不能為空\"}]})(d.default.createElement(i.default,{type:\"password\",placeholder:\"password\"})))),d.default.createElement(r.default,{onClick:(0,u.default)(l.default.mark(function t(){var n,a;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.form.getFieldsValue(),t.next=3,c.default.post(\"/api/login\",{email:n.account,password:n.userPwd},{headers:{\"Content-Type\":\"application/json\"}});case 3:a=t.sent,console.log(\"res\",a.data),a.data.name&&(console.log(\"login msg\",a.data),e.loginHandler(a.data.name));case 6:case\"end\":return t.stop()}},t,void 0)}))},\"登入\"),d.default.createElement(r.default,{icon:\"google\",onClick:function(){var e=null==window.screenLeft?window.screenX:window.screenLeft,t=null==window.screenTop?window.screenY:window.screenTop,n=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;window.open(\"/api/auth/google\",\"fbgoogle\",\"height=560,width=500,scrollbars=yes,top=\"+(a/2-250+t)+\",left=\"+(n/2-280+e))}},\"Google登入\"))})},339:function(e,t,n){var a=n(340);\"string\"==typeof a&&(a=[[e.i,a,\"\"]]);n(15)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},340:function(){},341:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(79)),l=a(n(342)),u=a(n(345)),o=a(n(128)),i=a(n(138)),d=a(n(348)),c=a(n(63)),s=a(n(64)),f=a(n(3)),m=a(n(18)),p=a(n(349)),h=a(n(6)),v=a(n(7)),g=a(n(5)),y=a(n(8)),b=a(n(353)),w=a(n(368));n(93),n(374),n(377),n(139),n(140),n(380),n(383),n(386),n(389);var E=n(1),_=a(E),k=a(n(141)),x=a(n(395)),M=a(n(396));n(397);var S=w.default.TreeNode,N=b.default.TabPane,H=function(e){function t(){var e,n,a,r,l=this;(0,h.default)(this,t);for(var u=arguments.length,o=Array(u),i=0;i<u;i++)o[i]=arguments[i];return n=a=(0,g.default)(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(o))),a.menu=[],a.selectData={},a.menu_id=\"\",a.permission=\"public\",a.state={menuTreeNode:[],canSave:!0,selectStructure:[],loading:!0,activeKey:\"1\"},a.renderMenu=function(e){return e.map(function(e){return e.children?\"public\"==e.permission?_.default.createElement(S,(0,f.default)({key:e.structure,title:e.name,icon:_.default.createElement(m.default,{type:\"folder\",theme:\"filled\"})},\"icon\",function(e){var t=e.expanded;return _.default.createElement(m.default,{type:t?\"folder-open\":\"folder\",theme:\"filled\"})}),a.renderMenu(e.children)):_.default.createElement(S,(0,f.default)({key:e.structure,title:e.name,icon:_.default.createElement(m.default,{type:\"folder\",theme:\"outlined\"})},\"icon\",function(e){return e.expanded?_.default.createElement(m.default,{type:\"folder-open\",theme:\"outlined\"}):_.default.createElement(\"span\",{className:\"iconfont\",style:{fontWeight:600}},\"\")}),a.renderMenu(e.children)):\"public\"===e.permission?_.default.createElement(S,{key:e.structure,title:e.name,icon:_.default.createElement(m.default,{type:\"file-text\",theme:\"outlined\"})}):_.default.createElement(S,{key:e.structure,title:e.name,icon:_.default.createElement(\"span\",{className:\"iconfont\",style:{fontWeight:600}},\"\")})})},a.selectHandler=function(e,t){t.selected,t.selectedNodes,t.node,t.event,a.selectData=(0,x.default)(e[0],a.menu),void 0===a.selectData.children?a.setState({selectStructure:[a.selectData.structure],canSave:!1}):a.setState({selectStructure:[a.selectData.structure],canSave:!0})},a.rootClickHandler=function(e){e.preventDefault(),a.selectData={},a.setState({canSave:!0,selectStructure:[]})},a.saveHandler=function(){var e;a.props.form.validateFields((e=(0,s.default)(c.default.mark(function e(t){var n,r,u,o,i,d,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt(\"return\");case 2:n=a.props.form.getFieldsValue(),\"1\"===a.state.activeKey?(r=a.strucHandler(),(u={}).structure=r,u.name=n.webName,u.url=n.webUrl,u.link=\"web\",u.path=\"/\"+a.props.userName+\"/\"+(0,M.default)(),u.permission=a.permission,o=a.setData(a.menu,a.selectData.structure,u),a.pushNewMenu(o,u)):(i=a.strucHandler(),(d={}).structure=i,d.name=n.folderName,d.permission=a.permission,d.children=[],s=a.setData(a.menu,a.selectData.structure,d),a.pushNewMenu(s,d));case 4:case\"end\":return e.stop()}},e,l)})),function(){return e.apply(this,arguments)}))},a.strucHandler=function(){var e=a.selectData;if(void 0!==e.children){if(0!=e.children.length){var t=e.children[e.children.length-1].structure;return t=(t=t.split(\"-\"))[t.length-1],e.structure+\"-\"+(parseInt(t)+1)}return e.structure+\"-0\"}var n=a.menu;return 0<n.length?\"0-\"+n.length:\"0-0\"},a.pushNewMenu=function(){var e=(0,s.default)(c.default.mark(function e(t,n){var r,u,o;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),r=a.menu_id,e.next=4,k.default.put(\"/api/menu/\"+r,{menu_id:r,menu:t});case 4:u=e.sent,k.default.post(\"/api/queue\",{menu:r,path:n.path,permission:n.permission,url:n.url}),console.log(\"axios res\",u.data.items),0<u.data.items.length?(a.menu=u.data.items,a.selectData=void 0===a.state.selectStructure[0]?{}:(0,x.default)(a.state.selectStructure[0],a.menu),o=a.renderMenu(u.data.items),a.setState({menuTreeNode:o,loading:!1}),a.props.form.resetFields(),d.default.success(\"收藏成功\",10)):d.default.error(\"收藏失敗\",10);case 8:case\"end\":return e.stop()}},e,l)}));return function(){return e.apply(this,arguments)}}(),a.setData=function(e,t,n){return void 0===t&&e.push(n),0==e.length?e.push(n):a.dataLoop(e,t,n,!1),e},a.dataLoop=function(e,t,n){for(var r=0;r<e.length;r++)if(e[r].structure!=t)void 0!==e[r].children&&a.dataLoop(e[r].children,t,n);else if(e[r].children){e[r].children.push(n);break}return e},a.permissionChange=function(e){a.permission=e?\"public\":\"private\"},a.changeTab=function(e){a.setState({activeKey:e})},a.goWebHandler=function(){var e=\"http://www.mynotemd.com/\"+a.props.userName;chrome.tabs.create({url:e})},r=n,(0,g.default)(a,r)}return(0,y.default)(t,e),(0,v.default)(t,[{key:\"render\",value:function(){var e=this.props.form,t=e.getFieldDecorator;return e.getFieldsError,e.getFieldError,e.isFieldTouched,_.default.createElement(\"div\",{className:\"default__box\"},_.default.createElement(b.default,{onChange:this.changeTab,defaultActiveKey:\"1\"},_.default.createElement(N,{tab:\"收藏網站\",key:\"1\"},\"1\"===this.state.activeKey?_.default.createElement(o.default,{layout:\"inline\"},_.default.createElement(o.default.Item,null,t(\"webName\",{rules:[{required:!0,message:\"請輸入收藏名稱\"}]})(_.default.createElement(i.default,{prefix:_.default.createElement(m.default,{type:\"edit\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入名稱\"}))),_.default.createElement(o.default.Item,null,t(\"webUrl\",{rules:[{required:!0,message:\"請輸入收藏網址\"}]})(_.default.createElement(i.default,{prefix:_.default.createElement(m.default,{type:\"global\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入網址\"})))):_.default.createElement(\"div\",null)),_.default.createElement(N,{tab:\"新增資料夾\",key:\"2\"},_.default.createElement(o.default,{layout:\"inline\"},\"2\"===this.state.activeKey?_.default.createElement(o.default.Item,null,t(\"folderName\",{rules:[{required:!0,message:\"請輸入資料夾名稱\"}]})(_.default.createElement(i.default,{prefix:_.default.createElement(m.default,{type:\"edit\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入名稱\"}))):_.default.createElement(o.default.Item,null,_.default.createElement(i.default,{prefix:_.default.createElement(m.default,{type:\"edit\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入名稱\"}))))),_.default.createElement(\"div\",null,_.default.createElement(\"a\",{onClick:this.rootClickHandler},\"+ 根目錄\")),_.default.createElement(u.default,{spinning:this.state.loading},_.default.createElement(w.default,{showIcon:!0,selectedKeys:this.state.selectStructure,onSelect:this.selectHandler},this.state.menuTreeNode)),_.default.createElement(\"div\",null,_.default.createElement(\"span\",null,\"瀏覽權限\"),_.default.createElement(l.default,{onChange:this.permissionChange,checkedChildren:\"公開\",unCheckedChildren:\"隱藏\",defaultChecked:!0})),this.state.canSave?_.default.createElement(r.default,{onClick:this.saveHandler},\"確認收藏\"):_.default.createElement(r.default,{disabled:!0},\"確認收藏\"),_.default.createElement(r.default,{onClick:this.goWebHandler},\"前往NOTE\"))}},{key:\"componentDidMount\",value:function(){var e=this;chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(t){var n=t[0].url,a=t[0].title;e.props.form.setFieldsValue({webUrl:n,webName:a})})}},{key:\"componentWillReceiveProps\",value:function(){var e=(0,s.default)(c.default.mark(function e(t){var n,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.default.get(\"/api/extensionMenu/\"+t.userName);case 2:(n=e.sent).data&&void 0!==n.data.items&&(this.menu_id=n.data.items[0].menu_id,n.data.items[0].menu&&(this.menu=n.data.items[0].menu,a=this.renderMenu(n.data.items[0].menu),this.setState({menuTreeNode:a,loading:!1})));case 4:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(E.Component);t.default=o.default.create()(H)},395:function(e,t){\"use strict\";var n;Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function e(t,a){for(var r=0;r<a.length;r++){if(a[r].structure==t){n=a[r];break}void 0!==a[r].children&&e(t,a[r].children)}return n}},396:function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+\"_\"+e()}},397:function(e,t,n){var a=n(398);\"string\"==typeof a&&(a=[[e.i,a,\"\"]]);n(15)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},398:function(){},399:function(e,t,n){var a=n(400);\"string\"==typeof a&&(a=[[e.i,a,\"\"]]);n(15)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},400:function(){}});","extractedComments":[]}