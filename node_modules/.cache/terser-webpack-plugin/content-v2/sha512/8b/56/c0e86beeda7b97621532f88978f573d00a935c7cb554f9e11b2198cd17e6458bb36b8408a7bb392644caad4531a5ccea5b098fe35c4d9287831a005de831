{"code":"!function(e){function t(t){for(var n,r,o=t[0],i=t[1],c=t[2],d=0,f=[];d<o.length;d++)r=o[d],l[r]&&f.push(l[r][0]),l[r]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);for(s&&s(t);f.length;)f.shift()();return u.push.apply(u,c||[]),a()}function a(){for(var e,t=0;t<u.length;t++){for(var a,r=u[t],o=!0,i=1;i<r.length;i++)a=r[i],0!==l[a]&&(o=!1);o&&(u.splice(t--,1),e=n(n.s=r[0]))}return e}function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}var r={},l={0:0},u=[];n.m=e,n.c=r,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\";var o=window.webpackJsonp=window.webpackJsonp||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var s=i;u.push([148,1]),a()}({148:function(e,t,a){e.exports=a(149)},149:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}var r=n(a(1)),l=n(a(9)),u=n(a(154));l.default.render(r.default.createElement(u.default,null),document.getElementById(\"app\"))},154:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(a(10)),l=n(a(1)),u=n(a(155)),o=n(a(203)),i=n(a(342));a(405),t.default=function(){var e=(0,u.default)(),t=e.isLogin,a=e.loginHandler,n=(0,r.default)(e,[\"isLogin\",\"loginHandler\"]);return l.default.createElement(\"div\",{className:\"wrapper\"},t?l.default.createElement(i.default,n):l.default.createElement(o.default,{loginHandler:a}))}},155:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(a(64)),l=n(a(65)),u=n(a(178)),o=a(1),i=(n(o),n(a(117)),n(a(80)));t.default=function(){var e=(0,o.useState)(!1),t=(0,u.default)(e,2),a=t[0],n=t[1],c=(0,o.useState)(\"\"),s=(0,u.default)(c,2),d=s[0],f=s[1],m=function(){var e=(0,l.default)(r.default.mark(function e(){var t;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(\"process env\",\"production\"),t=void 0,e.next=8;break;case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,i.default.get(\"/api/current_user\");case 10:t=e.sent;case 11:t.data&&void 0!==t.data.name&&(n(!0),f(t.data.name));case 12:case\"end\":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)(function(){m()},[]),{isLogin:a,loginHandler:function(e){e&&(n(!0),f(e))},userName:d}}},203:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(a(81)),l=n(a(64)),u=n(a(65)),o=n(a(130)),i=n(a(140));a(95),a(141),a(142);var c=n(a(1)),s=n(a(80));a(340),t.default=o.default.create({})(function(e){var t=e.form,a=t.getFieldDecorator;return t.getFieldsError,t.getFieldError,t.isFieldTouched,c.default.createElement(\"div\",{className:\"login__wrapper\"},c.default.createElement(\"div\",{className:\"login__box\"},c.default.createElement(\"div\",{className:\"box__header\"},c.default.createElement(\"h1\",{className:\"login__header-title\"},\"LOGIN NOTE\")),c.default.createElement(o.default,null,c.default.createElement(o.default.Item,{label:\"輸入帳號\",hasFeedback:!0},a(\"account\",{initialValue:\"\",rules:[{required:!0,message:\"用戶名不能為空\"},{validator:function(e,t,a){\"\"===t&&a(),/^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/.test(t)?a():a(\"僅能輸入email格式\")}}]})(c.default.createElement(i.default,{placeholder:\"account\"}))),c.default.createElement(o.default.Item,{label:\"輸入密碼\",hasFeedback:!0},a(\"userPwd\",{initialValue:\"\",rules:[{required:!0,message:\"密碼不能為空\"}]})(c.default.createElement(i.default,{type:\"password\",placeholder:\"password\"})))),c.default.createElement(r.default,{style:{width:\"100%\",fontWeight:\"bold\"},onClick:(0,u.default)(l.default.mark(function t(){var a,n;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.form.getFieldsValue(),t.next=3,s.default.post(\"/api/login\",{email:a.account,password:a.userPwd},{headers:{\"Content-Type\":\"application/json\"}});case 3:n=t.sent,console.log(\"res\",n.data),n.data.name&&(console.log(\"login msg\",n.data),e.loginHandler(n.data.name));case 6:case\"end\":return t.stop()}},t,void 0)}))},\"登入\"),c.default.createElement(\"div\",{className:\"google__login\"},c.default.createElement(\"p\",null,\"以社群帳號登入\"),c.default.createElement(r.default,{icon:\"google\",onClick:function(){var e=null==window.screenLeft?window.screenX:window.screenLeft,t=null==window.screenTop?window.screenY:window.screenTop,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,n=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;window.open(\"http://www.mynotemd.com/api/auth/google\",\"fbgoogle\",\"height=560,width=500,scrollbars=yes,top=\"+(n/2-250+t)+\",left=\"+(a/2-280+e))}},\"Google登入\"))))})},340:function(e,t,a){var n=a(341);\"string\"==typeof n&&(n=[[e.i,n,\"\"]]);a(14)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},341:function(){},342:function(e,t,a){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(a(81)),l=n(a(343)),u=n(a(346)),o=n(a(130)),i=n(a(140)),c=n(a(349)),s=n(a(354)),d=n(a(64)),f=n(a(65)),m=n(a(5)),p=n(a(18)),h=n(a(355)),v=n(a(4)),g=n(a(8)),b=n(a(3)),w=n(a(6)),y=n(a(359)),E=n(a(371));a(95),a(377),a(380),a(141),a(142),a(383),a(386),a(389),a(392),a(395);var _=a(1),k=n(_),N=n(a(80)),S=n(a(401)),x=n(a(402));a(403);var M=E.default.TreeNode,O=y.default.TabPane,D=function(e){function t(){var e,a,n,r,l=this;(0,v.default)(this,t);for(var u=arguments.length,o=Array(u),i=0;i<u;i++)o[i]=arguments[i];return a=n=(0,b.default)(this,(e=t.__proto__||(0,h.default)(t)).call.apply(e,[this].concat(o))),n.menu=[],n.selectData={},n.menu_id=\"\",n.permission=\"public\",n.inputInfo={},n.setOK=!1,n.url=\"https://hackmd.io/9QjNSr4BQ6-qy3wu6SvP5A\",n.state={menuTreeNode:[],canSave:!0,selectStructure:[],loading:!0,activeKey:\"1\",btnDisabled:!1,checkUrl:!1},n.renderMenu=function(e){return e.map(function(e){return e.children?\"public\"==e.permission?k.default.createElement(M,(0,m.default)({key:e.structure,title:e.name,icon:k.default.createElement(p.default,{type:\"folder\",theme:\"filled\"})},\"icon\",function(e){var t=e.expanded;return k.default.createElement(p.default,{type:t?\"folder-open\":\"folder\",theme:\"filled\"})}),n.renderMenu(e.children)):k.default.createElement(M,(0,m.default)({key:e.structure,title:e.name,icon:k.default.createElement(p.default,{type:\"folder\",theme:\"outlined\"})},\"icon\",function(e){return e.expanded?k.default.createElement(p.default,{type:\"folder-open\",theme:\"outlined\"}):k.default.createElement(\"span\",{className:\"iconfont\",style:{fontWeight:600}},\"\")}),n.renderMenu(e.children)):\"public\"===e.permission?k.default.createElement(M,{key:e.structure,title:e.name,icon:k.default.createElement(p.default,{type:\"file-text\",theme:\"outlined\"})}):k.default.createElement(M,{key:e.structure,title:e.name,icon:k.default.createElement(\"span\",{className:\"iconfont\",style:{fontWeight:600}},\"\")})})},n.selectHandler=function(e,t){t.selected,t.selectedNodes,t.node,t.event,n.selectData=(0,S.default)(e[0],n.menu),void 0===n.selectData.children?n.setState({selectStructure:[n.selectData.structure],canSave:!1}):n.setState({selectStructure:[n.selectData.structure],canSave:!0})},n.rootClickHandler=function(e){e.preventDefault(),n.selectData={},n.setState({canSave:!0,selectStructure:[]})},n.saveHandler=function(){var e;n.state.loading||n.props.form.validateFields((e=(0,f.default)(d.default.mark(function e(t){var a,r,u,o,i,c,s;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt(\"return\");case 2:a=n.props.form.getFieldsValue(),\"1\"===n.state.activeKey?(r=n.strucHandler(),(u={}).structure=r,u.name=a.webName,u.url=a.webUrl,u.link=\"web\",u.path=\"/\"+n.props.userName+\"/\"+(0,x.default)(),u.permission=n.permission,o=n.setData(n.menu,n.selectData.structure,u),n.pushNewMenu(o,u)):(i=n.strucHandler(),(c={}).structure=i,c.name=a.folderName,c.permission=n.permission,c.children=[],s=n.setData(n.menu,n.selectData.structure,c),n.pushNewMenu(s,c));case 4:case\"end\":return e.stop()}},e,l)})),function(){return e.apply(this,arguments)}))},n.strucHandler=function(){var e=n.selectData;if(void 0!==e.children){if(0!=e.children.length){var t=e.children[e.children.length-1].structure;return t=(t=t.split(\"-\"))[t.length-1],e.structure+\"-\"+(parseInt(t)+1)}return e.structure+\"-0\"}var a=n.menu;return 0<a.length?\"0-\"+a.length:\"0-0\"},n.pushNewMenu=function(){var e=(0,f.default)(d.default.mark(function e(t,a){var r,u,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({loading:!0,btnDisabled:!0}),r=n.menu_id,e.prev=2,e.next=5,N.default.put(\"/api/menu/\"+r,{menu_id:r,menu:t});case 5:u=e.sent,N.default.post(\"/api/queue\",{menu:r,path:a.path,permission:a.permission,url:a.url}),console.log(\"axios res\",u.data.items),0<u.data.items.length?(n.menu=u.data.items,n.selectData=void 0===n.state.selectStructure[0]?{}:(0,S.default)(n.state.selectStructure[0],n.menu),console.log(\"render again\"),o=n.renderMenu(u.data.items),n.setState({menuTreeNode:o,btnDisabled:!1,checkUrl:!0}),n.props.form.resetFields(),s.default.success(\"收藏成功\",5)):(n.setState({loading:!0}),s.default.success(\"收藏成功...\",5),setTimeout(function(){window.location.reload()},2e3)),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),n.setState({loading:!0}),s.default.success(\"收藏成功...\",5),setTimeout(function(){window.location.reload()},2e3);case 16:case\"end\":return e.stop()}},e,l,[[2,11]])}));return function(){return e.apply(this,arguments)}}(),n.setData=function(e,t,a){return void 0===t&&e.push(a),0==e.length?e.push(a):n.dataLoop(e,t,a,!1),e},n.dataLoop=function(e,t,a){for(var r=0;r<e.length;r++)if(e[r].structure!=t)void 0!==e[r].children&&n.dataLoop(e[r].children,t,a);else if(e[r].children){e[r].children.push(a);break}return e},n.permissionChange=function(e){n.permission=e?\"public\":\"private\"},n.changeTab=function(e){if(\"2\"===e){var t=n.props.form.getFieldsValue();n.inputInfo=t,n.setOK=!1,n.setState({canSave:!1})}else n.setState({canSave:!0});n.setState({activeKey:e})},n.goWebHandler=function(){var e=\"http://www.mynotemd.com/\"+n.props.userName;chrome.tabs.create({url:e})},r=a,(0,b.default)(n,r)}return(0,w.default)(t,e),(0,g.default)(t,[{key:\"render\",value:function(){var e=this.props.form,t=e.getFieldDecorator;return e.getFieldsError,e.getFieldError,e.isFieldTouched,k.default.createElement(\"div\",{className:\"default__box\"},this.state.checkUrl?k.default.createElement(c.default,{placement:\"left\",autoAdjustOverflow:!0,title:\"已收納\"},k.default.createElement(p.default,{className:\"checkUrl\",type:\"check-circle\",theme:\"outlined\",style:{color:\"#1bc3de\"}})):null,k.default.createElement(\"h1\",null,\"SAVE NOTES\"),k.default.createElement(y.default,{onChange:this.changeTab,defaultActiveKey:\"1\"},k.default.createElement(O,{tab:\"收藏網站\",key:\"1\"},\"1\"===this.state.activeKey?k.default.createElement(o.default,{layout:\"inline\"},k.default.createElement(o.default.Item,null,t(\"webName\",{initialValue:this.inputInfo.webName,rules:[{required:!0,message:\"請輸入收藏名稱\"}]})(k.default.createElement(i.default,{prefix:k.default.createElement(p.default,{type:\"edit\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入名稱\"}))),k.default.createElement(o.default.Item,null,t(\"webUrl\",{initialValue:this.inputInfo.webUrl,rules:[{required:!0,message:\"請輸入收藏網址\"}]})(k.default.createElement(i.default,{prefix:k.default.createElement(p.default,{type:\"global\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入網址\"})))):k.default.createElement(\"div\",null)),k.default.createElement(O,{tab:\"新增資料夾\",key:\"2\"},k.default.createElement(o.default,{layout:\"inline\"},\"2\"===this.state.activeKey?k.default.createElement(o.default.Item,null,t(\"folderName\",{rules:[{required:!0,message:\"請輸入資料夾名稱\"}]})(k.default.createElement(i.default,{prefix:k.default.createElement(p.default,{type:\"edit\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入名稱\"}))):k.default.createElement(o.default.Item,null,k.default.createElement(i.default,{prefix:k.default.createElement(p.default,{type:\"edit\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入名稱\"}))))),k.default.createElement(\"div\",{className:\"backRoot\"},k.default.createElement(\"a\",{onClick:this.rootClickHandler},\"+ 至根目錄\")),k.default.createElement(u.default,{spinning:this.state.loading},k.default.createElement(\"div\",{className:\"menu__box\"},k.default.createElement(E.default,{showIcon:!0,selectedKeys:this.state.selectStructure,onSelect:this.selectHandler},this.state.menuTreeNode))),k.default.createElement(\"div\",{className:\"permission\"},k.default.createElement(\"span\",{className:\"permission__text\"},\"瀏覽權限\"),k.default.createElement(l.default,{onChange:this.permissionChange,checkedChildren:\"公開\",unCheckedChildren:\"隱藏\",defaultChecked:!0})),k.default.createElement(\"div\",{className:\"btn__box\"},this.state.canSave?k.default.createElement(r.default,{disabled:this.state.btnDisabled,icon:\"select\",onClick:this.saveHandler},\"確認收藏\"):k.default.createElement(r.default,{icon:\"select\",disabled:!0},\"確認\"),k.default.createElement(r.default,{icon:\"home\",onClick:this.goWebHandler},\"前往NOTE\")))}},{key:\"componentDidMount\",value:function(){var e=(0,f.default)(d.default.mark(function e(){var t;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this,chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(e){var a=e[0].url,n=e[0].title;this.url=a,t.props.form.setFieldsValue({webUrl:a,webName:n})});case 2:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:\"componentWillReceiveProps\",value:function(){var e=(0,f.default)(d.default.mark(function e(t){var a,n,r,l=this;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.default.get(\"/api/extensionMenu/\"+t.userName);case 2:return a=e.sent,console.log(\"res name\",t.userName),e.next=6,N.default.get(\"/api/menu/\"+t.userName+\"/checkUrl?url=\"+this.url);case 6:\"true\"===(n=e.sent).data.msg&&this.setState({checkUrl:!0}),console.log(\"result\",n),a.data&&void 0!==a.data.items&&(console.log(\"res.data\",a.data),this.menu_id=a.data.items[0].menu_id,a.data.items[0].menu&&(this.menu=a.data.items[0].menu,r=this.renderMenu(a.data.items[0].menu),this.setState({menuTreeNode:r}),setTimeout(function(){l.setState({loading:!1})},500),console.log(\"loadin true\")));case 10:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(_.Component);t.default=o.default.create()(D)},401:function(e,t){\"use strict\";var a;Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function e(t,n){for(var r=0;r<n.length;r++){if(n[r].structure==t){a=n[r];break}void 0!==n[r].children&&e(t,n[r].children)}return a}},402:function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+\"_\"+e()}},403:function(e,t,a){var n=a(404);\"string\"==typeof n&&(n=[[e.i,n,\"\"]]);a(14)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},404:function(){},405:function(e,t,a){var n=a(406);\"string\"==typeof n&&(n=[[e.i,n,\"\"]]);a(14)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},406:function(){},80:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a(117)).default.create({baseURL:\"http://www.mynotemd.com\",timeout:5e3});t.default=n}});","extractedComments":[]}