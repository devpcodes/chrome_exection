{"code":"!function(e){function t(t){for(var a,r,o=t[0],s=t[1],d=t[2],c=0,f=[];c<o.length;c++)r=o[c],l[r]&&f.push(l[r][0]),l[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(i&&i(t);f.length;)f.shift()();return u.push.apply(u,d||[]),n()}function n(){for(var e,t=0;t<u.length;t++){for(var n,r=u[t],o=!0,s=1;s<r.length;s++)n=r[s],0!==l[n]&&(o=!1);o&&(u.splice(t--,1),e=a(a.s=r[0]))}return e}function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}var r={},l={0:0},u=[];a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,\"a\",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p=\"\";var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var i=s;u.push([145,1]),n()}({138:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(n(112)).default.create({baseURL:\"http://localhost\",timeout:5e3});t.default=a},145:function(e,t,n){e.exports=n(146)},146:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}var r=a(n(1)),l=a(n(15)),u=a(n(151));l.default.render(r.default.createElement(u.default,null),document.getElementById(\"app\"))},151:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(19)),l=a(n(1)),u=a(n(152)),o=a(n(200)),s=a(n(340));n(374),t.default=function(){var e=(0,u.default)(),t=e.isLogin,n=e.loginHandler,a=(0,r.default)(e,[\"isLogin\",\"loginHandler\"]);return l.default.createElement(\"div\",null,t?l.default.createElement(s.default,a):l.default.createElement(o.default,{loginHandler:n}))}},152:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(61)),l=a(n(62)),u=a(n(175)),o=n(1),s=(a(o),a(n(112)));t.default=function(){var e=(0,o.useState)(!1),t=(0,u.default)(e,2),n=t[0],a=t[1],d=(0,o.useState)(\"\"),i=(0,u.default)(d,2),c=i[0],f=i[1],p=function(){var e=(0,l.default)(r.default.mark(function e(){var t;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(\"process env\",\"production\"),t=void 0,e.next=8;break;case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,s.default.get(\"http://localhost/api/current_user\");case 10:t=e.sent;case 11:t.data&&void 0!==t.data.name&&(a(!0),f(t.data.name));case 12:case\"end\":return e.stop()}},e,void 0)}));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)(function(){p()},[]),{isLogin:n,loginHandler:function(e){e&&(a(!0),f(e))},userName:c}}},200:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(77)),l=a(n(61)),u=a(n(62)),o=a(n(125)),s=a(n(135));n(91),n(136),n(137);var d=a(n(1)),i=a(n(138));n(338),t.default=o.default.create({})(function(e){var t=e.form,n=t.getFieldDecorator;return t.getFieldsError,t.getFieldError,t.isFieldTouched,d.default.createElement(\"div\",{className:\"login__box\"},d.default.createElement(o.default,null,d.default.createElement(o.default.Item,{label:\"輸入帳號\",hasFeedback:!0},n(\"account\",{initialValue:\"\",rules:[{required:!0,message:\"用戶名不能為空\"},{validator:function(e,t,n){\"\"===t&&n(),/^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/.test(t)?n():n(\"僅能輸入email格式\")}}]})(d.default.createElement(s.default,{placeholder:\"account\"}))),d.default.createElement(o.default.Item,{label:\"輸入密碼\",hasFeedback:!0},n(\"userPwd\",{initialValue:\"\",rules:[{required:!0,message:\"密碼不能為空\"}]})(d.default.createElement(s.default,{type:\"password\",placeholder:\"password\"})))),d.default.createElement(r.default,{onClick:(0,u.default)(l.default.mark(function t(){var n,a;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.form.getFieldsValue(),t.next=3,i.default.post(\"/api/login\",{email:n.account,password:n.userPwd},{headers:{\"Content-Type\":\"application/json\"}});case 3:a=t.sent,console.log(\"res\",a.data),a.data.name&&(console.log(\"login msg\",a.data),e.loginHandler(a.data.name));case 6:case\"end\":return t.stop()}},t,void 0)}))},\"登入\"))})},338:function(e,t,n){var a=n(339);\"string\"==typeof a&&(a=[[e.i,a,\"\"]]);n(16)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},339:function(){},340:function(e,t,n){\"use strict\";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var r=a(n(77)),l=a(n(341)),u=a(n(125)),o=a(n(135)),s=a(n(344)),d=a(n(61)),i=a(n(62)),c=a(n(4)),f=a(n(22)),p=a(n(345)),m=a(n(5)),h=a(n(7)),v=a(n(6)),g=a(n(8)),y=a(n(349));n(91),n(355),n(136),n(137),n(358),n(361),n(364);var b=n(1),_=a(b),E=a(n(138)),w=a(n(370)),x=a(n(371));n(372);var k=y.default.TreeNode,M=function(e){function t(){var e,n,a,r,l=this;(0,m.default)(this,t);for(var u=arguments.length,o=Array(u),h=0;h<u;h++)o[h]=arguments[h];return n=a=(0,v.default)(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(o))),a.menu=[],a.selectData={},a.menu_id=\"\",a.state={menuTreeNode:[],canSave:!0,selectStructure:[],loading:!0},a.renderMenu=function(e){return e.map(function(e){return e.children?\"public\"==e.permission?_.default.createElement(k,(0,c.default)({key:e.structure,title:e.name,icon:_.default.createElement(f.default,{type:\"folder\",theme:\"filled\"})},\"icon\",function(e){var t=e.expanded;return _.default.createElement(f.default,{type:t?\"folder-open\":\"folder\",theme:\"filled\"})}),a.renderMenu(e.children)):_.default.createElement(k,(0,c.default)({key:e.structure,title:e.name,icon:_.default.createElement(f.default,{type:\"folder\",theme:\"outlined\"})},\"icon\",function(e){return e.expanded?_.default.createElement(f.default,{type:\"folder-open\",theme:\"outlined\"}):_.default.createElement(\"span\",{className:\"iconfont\",style:{fontWeight:600}},\"\")}),a.renderMenu(e.children)):\"public\"===e.permission?_.default.createElement(k,{key:e.structure,title:e.name,icon:_.default.createElement(f.default,{type:\"file-text\",theme:\"outlined\"})}):_.default.createElement(k,{key:e.structure,title:e.name,icon:_.default.createElement(\"span\",{className:\"iconfont\",style:{fontWeight:600}},\"\")})})},a.selectHandler=function(e,t){t.selected,t.selectedNodes,t.node,t.event,console.log(\"selectedkeys\",e),a.selectData=(0,w.default)(e[0],a.menu),void 0===a.selectData.children?a.setState({selectStructure:[a.selectData.structure],canSave:!1}):a.setState({selectStructure:[a.selectData.structure],canSave:!0}),console.log(\"select data\",a.selectData)},a.rootClickHandler=function(e){e.preventDefault(),a.setState({canSave:!0,selectStructure:[]})},a.saveHandler=function(){var e;a.props.form.validateFields((e=(0,i.default)(d.default.mark(function e(t){var n,r,u,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt(\"return\");case 2:n=a.props.form.getFieldsValue(),r=a.strucHandler(),(u={}).structure=r,u.name=n.webName,u.url=n.webUrl,u.link=\"web\",u.path=\"/\"+a.props.userName+\"/\"+(0,x.default)(),u.permission=\"public\",o=a.setData(a.menu,a.selectData.structure,u),a.pushNewMenu(o,u),console.log(\"input\",n,r,o);case 14:case\"end\":return e.stop()}},e,l)})),function(){return e.apply(this,arguments)}))},a.strucHandler=function(){var e=a.selectData;if(0!=e.children.length){var t=e.children[e.children.length-1].structure;return t=(t=t.split(\"-\"))[t.length-1],e.structure+\"-\"+(parseInt(t)+1)}return e.structure+\"-0\"},a.pushNewMenu=function(){var e=(0,i.default)(d.default.mark(function e(t,n){var r,u,o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),r=a.menu_id,e.next=4,E.default.put(\"/api/menu/\"+r,{menu_id:r,menu:t});case 4:u=e.sent,E.default.post(\"/api/queue\",{menu:r,path:n.path,permission:n.permission,url:n.url}),console.log(\"axios res\",u.data.items),0<u.data.items.length?(a.menu=u.data.items,o=a.renderMenu(u.data.items),a.setState({menuTreeNode:o,loading:!1}),a.props.form.resetFields(),s.default.success(\"收藏成功\",10)):s.default.success(\"收藏失敗\",10);case 8:case\"end\":return e.stop()}},e,l)}));return function(){return e.apply(this,arguments)}}(),a.setData=function(e,t,n){return 0==e.length?e.push(n):a.dataLoop(e,t,n,!1),e},a.dataLoop=function(e,t,n){for(var r=0;r<e.length;r++)if(e[r].structure!=t)void 0!==e[r].children&&a.dataLoop(e[r].children,t,n);else if(e[r].children){e[r].children.push(n);break}return e},r=n,(0,v.default)(a,r)}return(0,g.default)(t,e),(0,h.default)(t,[{key:\"render\",value:function(){var e=this.props.form,t=e.getFieldDecorator;return e.getFieldsError,e.getFieldError,e.isFieldTouched,_.default.createElement(\"div\",{className:\"default__box\"},_.default.createElement(u.default,{layout:\"inline\"},_.default.createElement(u.default.Item,null,t(\"webName\",{rules:[{required:!0,message:\"請輸入收藏名稱\"}]})(_.default.createElement(o.default,{prefix:_.default.createElement(f.default,{type:\"edit\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入名稱\"}))),_.default.createElement(u.default.Item,null,t(\"webUrl\",{rules:[{required:!0,message:\"請輸入收藏網址\"}]})(_.default.createElement(o.default,{prefix:_.default.createElement(f.default,{type:\"global\",style:{color:\"rgba(0,0,0,.25)\"}}),placeholder:\"請輸入網址\"})))),_.default.createElement(\"div\",null,_.default.createElement(\"a\",{onClick:this.rootClickHandler},\"+ 根目錄\")),_.default.createElement(l.default,{spinning:this.state.loading},_.default.createElement(y.default,{showIcon:!0,selectedKeys:this.state.selectStructure,onSelect:this.selectHandler},this.state.menuTreeNode)),this.state.canSave?_.default.createElement(r.default,{onClick:this.saveHandler},\"確認收藏\"):_.default.createElement(r.default,{disabled:!0},\"確認收藏\"),_.default.createElement(r.default,null,\"前往NOTE\"))}},{key:\"componentDidMount\",value:function(){var e=this;console.log(\"abc\"),chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(t){var n=t[0].url;console.log(n),e.props.form.setFieldsValue({webUrl:n})})}},{key:\"componentWillReceiveProps\",value:function(){var e=(0,i.default)(d.default.mark(function e(t){var n,a;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(\"un---\",t.userName),e.next=3,E.default.get(\"/api/extensionMenu/\"+t.userName);case 3:(n=e.sent).data&&void 0!==n.data.items&&(this.menu_id=n.data.items[0].menu_id,n.data.items[0].menu.length&&(console.log(\"res.data.items[0].menu\",n.data.items[0].menu),this.menu=n.data.items[0].menu,a=this.renderMenu(n.data.items[0].menu),this.setState({menuTreeNode:a,loading:!1})));case 5:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(b.Component);t.default=u.default.create()(M)},370:function(e,t){\"use strict\";var n;Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function e(t,a){for(var r=0;r<a.length;r++){if(a[r].structure==t){n=a[r];break}void 0!==a[r].children&&e(t,a[r].children)}return n}},371:function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+\"_\"+e()}},372:function(e,t,n){var a=n(373);\"string\"==typeof a&&(a=[[e.i,a,\"\"]]);n(16)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},373:function(){},374:function(e,t,n){var a=n(375);\"string\"==typeof a&&(a=[[e.i,a,\"\"]]);n(16)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},375:function(){}});","extractedComments":[]}